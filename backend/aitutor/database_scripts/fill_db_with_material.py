import os
import sys
import django
from datetime import date

# Добавляем путь к проекту
sys.path.append('/home/nadgox/Public/PublicProjects/Python/AI-Tutorial/backend/aitutor')
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'aitutor.settings')

# Инициализируем Django
django.setup()

from tutorials.models import Language, Manual, Topic, Tutorial, ColorScheme

def create_educational_content():
    # Очищаем существующие данные
    Tutorial.objects.all().delete()
    Topic.objects.all().delete()
    Manual.objects.all().delete()

    # Словарь с учебными материалами
    language_contents = {
        'Python': {
            'manuals': [
                {
                    'name': 'Основы Python',
                    'topics': [
                        {
                            'name': 'Основы Python',
                            'tutorials': [
                                {'name': 'Введение в написание программ', 'content': 'Основы программирования на Python'},
                                {'name': 'Переменные и типы данных', 'content': 'Изучение переменных и типов данных'},
                                {'name': 'Консольный ввод и вывод', 'content': 'Работа с консольным вводом и выводом'},
                                {'name': 'Арифметические операции с числами', 'content': 'Выполнение арифметических операций'},
                                {'name': 'Поразрядные операции с числами', 'content': 'Битовые операции в Python'},
                                {'name': 'Условные выражения', 'content': 'Основы условных выражений'},
                                {'name': 'Условная конструкция if', 'content': 'Использование условной конструкции if'},
                                {'name': 'Циклы', 'content': 'Работа с циклами в Python'},
                                {'name': 'Функции', 'content': 'Создание и использование функций'},
                                {'name': 'Параметры функции', 'content': 'Работа с параметрами функций'},
                                {'name': 'Оператор return и возвращение результата из функции', 'content': 'Возврат значений из функций'},
                                {'name': 'Функция как тип, параметр и результат другой функции', 'content': 'Функции высшего порядка'},
                                {'name': 'Лямбда-выражения', 'content': 'Использование лямбда-выражений'},
                                {'name': 'Преобразование типов', 'content': 'Конвертация между типами данных'},
                                {'name': 'Область видимости переменных', 'content': 'Понятие области видимости'},
                                {'name': 'Замыкания', 'content': 'Изучение замыканий'},
                                {'name': 'Декораторы', 'content': 'Работа с декораторами'}
                            ]
                        },
                        {
                            'name': 'Объектно-ориентированное программирование',
                            'tutorials': [
                                {'name': 'Классы и объекты', 'content': 'Основы ООП'},
                                {'name': 'Инкапсуляция, атрибуты и свойства', 'content': 'Инкапсуляция в Python'},
                                {'name': 'Наследование', 'content': 'Механизм наследования'},
                                {'name': 'Переопределение функционала базового класса', 'content': 'Переопределение методов'},
                                {'name': 'Атрибуты классов и статические методы', 'content': 'Статические методы и атрибуты'},
                                {'name': 'Класс object. Строковое представление объекта', 'content': 'Методы класса object'},
                                {'name': 'Перегрузка операторов', 'content': 'Магические методы'},
                                {'name': 'Абстрактные классы и методы', 'content': 'Абстракции в Python'}
                            ]
                        },
                        {
                            'name': 'Обработка ошибок и исключений',
                            'tutorials': [
                                {'name': 'Конструкция try...except...finally', 'content': 'Обработка исключений'},
                                {'name': 'except и обработка разных типов исключений', 'content': 'Типы исключений'},
                                {'name': 'Генерация исключений и создание своих типов исключений', 'content': 'Пользовательские исключения'}
                            ]
                        },
                        {
                            'name': 'Списки, кортежи и словари',
                            'tutorials': [
                                {'name': 'Списки', 'content': 'Работа со списками'},
                                {'name': 'Кортежи', 'content': 'Использование кортежей'},
                                {'name': 'Диапазоны', 'content': 'Создание и использование диапазонов'},
                                {'name': 'Словари', 'content': 'Работа со словарями'},
                                {'name': 'Множества', 'content': 'Операции с множествами'},
                                {'name': 'List comprehension', 'content': 'Списковые включения'},
                                {'name': 'Упаковка и распаковка', 'content': 'Основы упаковки и распаковки'},
                                {'name': 'Упаковка и распаковка в параметрах функций', 'content': 'Расширенные техники упаковки'}
                            ]
                        },
                        {
                            'name': 'Модули',
                            'tutorials': [
                                {'name': 'Определение и подключение модулей', 'content': 'Работа с модулями'},
                                {'name': 'Генерация байткода модулей', 'content': 'Компиляция модулей'},
                                {'name': 'Модуль random', 'content': 'Генерация случайных чисел'},
                                {'name': 'Математические функции и модуль math', 'content': 'Математические операции'},
                                {'name': 'Модуль locale', 'content': 'Локализация'},
                                {'name': 'Модуль decimal', 'content': 'Точные вычисления'},
                                {'name': 'Модуль dataclasses. Data-классы', 'content': 'Использование data-классов'}
                            ]
                        },
                        {
                            'name': 'Строки',
                            'tutorials': [
                                {'name': 'Работа со строками', 'content': 'Основы работы со строками'},
                                {'name': 'Основные методы строк', 'content': 'Методы строковых объектов'},
                                {'name': 'Форматирование', 'content': 'Форматирование строк'}
                            ]
                        },
                        {
                            'name': 'Pattern matching',
                            'tutorials': [
                                {'name': 'Конструкция match', 'content': 'Основы pattern matching'},
                                {'name': 'Кортежи в pattern matching', 'content': 'Сопоставление кортежей'},
                                {'name': 'Массивы в pattern matching', 'content': 'Сопоставление массивов'},
                                {'name': 'Словари в pattern matching', 'content': 'Сопоставление словарей'},
                                {'name': 'Классы в pattern matching', 'content': 'Сопоставление классов'},
                                {'name': 'guards или ограничения шаблонов', 'content': 'Ограничения в pattern matching'},
                                {'name': 'Установка псевдонимов и паттерн AS', 'content': 'Псевдонимы в pattern matching'}
                            ]
                        },
                        {
                            'name': 'Работа с файлами',
                            'tutorials': [
                                {'name': 'Открытие и закрытие файлов', 'content': 'Основы работы с файлами'},
                                {'name': 'Текстовые файлы', 'content': 'Чтение и запись текстовых файлов'},
                                {'name': 'Файлы CSV', 'content': 'Работа с CSV'},
                                {'name': 'Бинарные файлы', 'content': 'Операции с бинарными файлами'},
                                {'name': 'Модуль shelve', 'content': 'Использование shelve'},
                                {'name': 'Модуль OS и работа с файловой системой', 'content': 'Операции с файловой системой'},
                                {'name': 'Программа подсчета слов', 'content': 'Пример программы подсчета слов'},
                                {'name': 'Запись и чтение архивных zip-файлов', 'content': 'Работа с zip-архивами'}
                            ]
                        },
                        {
                            'name': 'Работа с датами и временем',
                            'tutorials': [
                                {'name': 'Модуль datetime', 'content': 'Работа с датами и временем'},
                                {'name': 'Операции с датами', 'content': 'Основные операции с датами'}
                            ]
                        }
                    ]
                }
            ]
        },
        'C++': {
            'manuals': [
                {
                    'name': 'Основы C++',
                    'topics': [
                        {
                            'name': 'Введение в C++',
                            'tutorials': [
                                {
                                    'name': 'Компиляция и основы синтаксиса',
                                    'content': '''
# Введение в C++: Компиляция и основы синтаксиса
'''
                                },
                                {
                                    'name': 'Классы и объектно-ориентированное программирование',
                                    'content': '''
# Объектно-ориентированное программирование в C++
'''
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        'Java': {
            'manuals': [
                {
                    'name': 'Основы Java',
                    'topics': [
                        {
                            'name': 'Введение в Java',
                            'tutorials': [
                                {
                                    'name': 'Первое приложение',
                                    'content': 'Создаем первую программу на Java'
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        'Kotlin': {
            'manuals': [
                {
                    'name': 'Основы Kotlin',
                    'topics': [
                        {
                            'name': 'Основы языка Kotlin',
                            'tutorials': [
                                {'name': 'Структура программы', 'content': 'Основы структуры программы в Kotlin'},
                                {'name': 'Переменные', 'content': 'Работа с переменными'},
                                {'name': 'Типы данных', 'content': 'Изучение типов данных в Kotlin'},
                                {'name': 'Консольный ввод и вывод', 'content': 'Работа с консольным вводом и выводом'},
                                {'name': 'Операции с числами', 'content': 'Арифметические и математические операции'},
                                {'name': 'Условные выражения', 'content': 'Основы условных выражений'},
                                {'name': 'Условная конструкция if...else', 'content': 'Использование if...else'},
                                {'name': 'Конструкция when', 'content': 'Работа с конструкцией when'},
                                {'name': 'Циклы', 'content': 'Типы циклов в Kotlin'},
                                {'name': 'Диапазоны', 'content': 'Использование диапазонов'},
                                {'name': 'Ведение в массивы', 'content': 'Основы работы с массивами'}
                            ]
                        },
                        {
                            'name': 'Функциональное программирование',
                            'tutorials': [
                                {'name': 'Функции и их параметры', 'content': 'Создание и использование функций'},
                                {'name': 'Переменное количество параметров. Vararg', 'content': 'Работа с vararg'},
                                {'name': 'Возвращение результата. Оператор return', 'content': 'Использование оператора return'},
                                {'name': 'Однострочные и локальные функции', 'content': 'Особенности функций'},
                                {'name': 'Перегрузка функций', 'content': 'Перегрузка функций в Kotlin'},
                                {'name': 'Тип функции', 'content': 'Понятие типа функции'},
                                {'name': 'Функции высокого порядка', 'content': 'Функции высшего порядка'},
                                {'name': 'Анонимные функции', 'content': 'Работа с анонимными функциями'},
                                {'name': 'Лямбда-выражения', 'content': 'Использование лямбда-выражений'},
                                {'name': 'Замыкания', 'content': 'Понятие замыканий'}
                            ]
                        },
                        {
                            'name': 'Объектно-ориентированное программирование',
                            'tutorials': [
                                {'name': 'Классы и объекты', 'content': 'Основы ООП в Kotlin'},
                                {'name': 'Конструкторы', 'content': 'Работа с конструкторами'},
                                {'name': 'Пакеты и импорт', 'content': 'Организация кода'},
                                {'name': 'Наследование', 'content': 'Механизм наследования'},
                                {'name': 'Модификаторы видимости', 'content': 'Управление доступом'},
                                {'name': 'Геттеры и сеттеры', 'content': 'Работа с геттерами и сеттерами'},
                                {'name': 'Переопределение методов и свойств', 'content': 'Переопределение в Kotlin'},
                                {'name': 'Абстрактные классы и методы', 'content': 'Абстракции'},
                                {'name': 'Интерфейсы', 'content': 'Работа с интерфейсами'},
                                {'name': 'Вложенные и внутренние классы и интерфейсы', 'content': 'Вложенные типы'},
                                {'name': 'Data-классы', 'content': 'Использование data-классов'},
                                {'name': 'Перечисления enums', 'content': 'Работа с перечислениями'},
                                {'name': 'Делегирование', 'content': 'Механизм делегирования'},
                                {'name': 'Анонимные классы и объекты', 'content': 'Анонимные типы'},
                                {'name': 'Companion-объекты', 'content': 'Использование companion-объектов'}
                            ]
                        },
                        {
                            'name': 'Обобщения',
                            'tutorials': [
                                {'name': 'Обобщенные классы и функции', 'content': 'Основы обобщений'},
                                {'name': 'Ограничения обобщений', 'content': 'Ограничения типов'},
                                {'name': 'Вариантность, ковариантность и контравариантность', 'content': 'Продвинутые концепции обобщений'}
                            ]
                        },
                        {
                            'name': 'Дополнительные возможности ООП',
                            'tutorials': [
                                {'name': 'Обработка исключений', 'content': 'Работа с исключениями'},
                                {'name': 'Null и nullable-типы', 'content': 'Безопасная работа с null'},
                                {'name': 'Преобразование типов', 'content': 'Приведение типов'},
                                {'name': 'Функции расширения', 'content': 'Расширение функциональности'},
                                {'name': 'Перегрузка операторов', 'content': 'Кастомные операторы'},
                                {'name': 'Делегированные свойства', 'content': 'Делегирование свойств'},
                                {'name': 'Scope-функции', 'content': 'Функции области видимости'},
                                {'name': 'Инфиксная нотация', 'content': 'Особенности инфиксных вызовов'}
                            ]
                        },
                        {
                            'name': 'Коллекции и последовательности',
                            'tutorials': [
                                {'name': 'Изменяемые и неизменяемые коллекции', 'content': 'Типы коллекций'},
                                {'name': 'List', 'content': 'Работа со списками'},
                                {'name': 'Set', 'content': 'Множества в Kotlin'},
                                {'name': 'Map', 'content': 'Словари и отображения'},
                                {'name': 'Последовательности', 'content': 'Работа с последовательностями'},
                                {'name': 'Массивы', 'content': 'Операции с массивами'},
                                {'name': 'Отличие последовательности от коллекций Iterable', 'content': 'Сравнение коллекций'},
                                {'name': 'Фильтрация', 'content': 'Фильтрация элементов'},
                                {'name': 'Проверка элементов', 'content': 'Проверка условий'},
                                {'name': 'Трансформации', 'content': 'Преобразование коллекций'},
                                {'name': 'Группировка', 'content': 'Группировка элементов'},
                                {'name': 'Сортировка', 'content': 'Сортировка коллекций'},
                                {'name': 'Агрегатные операции', 'content': 'Агрегация данных'},
                                {'name': 'Сложение, вычитание и объединение коллекций', 'content': 'Операции с коллекциями'},
                                {'name': 'Получение части элементов', 'content': 'Срезы коллекций'},
                                {'name': 'Получение отдельных элементов', 'content': 'Извлечение элементов'}
                            ]
                        },
                        {
                            'name': 'Корутины',
                            'tutorials': [
                                {'name': 'Введение в корутины', 'content': 'Основы асинхронного программирования'},
                                {'name': 'Область корутины', 'content': 'Управление областью корутин'},
                                {'name': 'launch и Job', 'content': 'Запуск и управление корутинами'},
                                {'name': 'Async, await и Deferred', 'content': 'Асинхронные вычисления'},
                                {'name': 'Диспетчер корутины', 'content': 'Управление потоками выполнения'},
                                {'name': 'Отмена выполнения корутин', 'content': 'Прерывание корутин'},
                                {'name': 'Каналы', 'content': 'Коммуникация между корутинами'}
                            ]
                        },
                        {
                            'name': 'Асинхронные потоки',
                            'tutorials': [
                                {'name': 'Введение в асинхронные потоки', 'content': 'Основы асинхронных потоков'},
                                {'name': 'Создание асинхронного потока', 'content': 'Создание потоков'},
                                {'name': 'Операции с потоками', 'content': 'Манипуляции с потоками'}
                            ]
                        }
                    ]
                }
            ]
        },
        'Ruby': {
            'manuals': [
                {
                    'name': 'Основы Ruby',
                    'topics': [
                        {
                            'name': 'Введение в Ruby',
                            'tutorials': [
                                {
                                    'name': 'Первая программа',
                                    'content': 'Начинаем программировать на Ruby'
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    }

    # Заполнение базы данных
    for lang_name, lang_content in language_contents.items():
        try:
            language = Language.objects.get(name=lang_name)
            
            for manual_data in lang_content['manuals']:
                manual = Manual.objects.create(
                    name=manual_data['name'],
                    language=language,
                    publication_date=date.today()
                )
                
                for topic_data in manual_data['topics']:
                    topic = Topic.objects.create(
                        name=topic_data['name'],
                        manual=manual
                    )
                    
                    for tutorial_data in topic_data['tutorials']:
                        Tutorial.objects.create(
                            name=tutorial_data['name'],
                            content=tutorial_data['content'],
                            topic=topic,
                            publication_date=date.today()
                        )
                
                print(f"Создан учебный материал для {lang_name}")
        
        except Language.DoesNotExist:
            print(f"Язык {lang_name} не найден")

def main():
    create_educational_content()
    print("Учебные материалы успешно добавлены!")

if __name__ == '__main__':
    main()